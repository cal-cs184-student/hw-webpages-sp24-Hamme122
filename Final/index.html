<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CS-184 Final Project: Fluid and Smoke Animation on GPU</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="520ccbe6-40be-4e95-be7a-d63a1df1971f" class="page sans"><header><img class="page-cover-image" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/%25E5%25BE%25AE%25E4%25BF%25A1%25E5%259B%25BE%25E7%2589%2587_20240501012451.png" style="object-position:center 50%"/><h1 class="page-title"><strong>CS-184 Final Project: Fluid and Smoke Animation on GPU</strong></h1><p class="page-description"></p></header><div class="page-body"><figure id="5a6c45b7-695f-4e30-b3b8-ea2a7512dafe" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="1.2em"><mtext>Team Members: Xuanye Chen, Zhenzhe Li, Ruijie Jian, Huasen Xi</mtext></mstyle></mrow><annotation encoding="application/x-tex">\large \text{Team Members: Xuanye Chen, Zhenzhe Li, Ruijie Jian, Huasen Xi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0667em;vertical-align:-0.2333em;"></span><span class="mord text sizing reset-size6 size7"><span class="mord">Team Members: Xuanye Chen, Zhenzhe Li, Ruijie Jian, Huasen Xi</span></span></span></span></span></span></div></figure><nav id="8d5884be-01f2-4e3c-a108-c4fd91f52d30" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#15b7d7a6-b0cf-4222-a8f6-10ce973144a3">1. Abstract</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#846a9a20-cab9-4cd9-9524-45742c590eef">2. Technical approach</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#20a9cf76-c681-4530-929f-f0d22d4e4407">2.0 Preliminary: Volumetric Path Tracing</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#efe05829-2e50-4e31-849f-55ef4ea7e760">2.0.1 Path Tracing(Lessons learned)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#687a8691-828b-4db7-9057-bb41f43ebcd4">2.0.2 Volumetric Path Tracing</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a6f6ea69-ec76-4695-99ab-ee7c271d5f56">2.1 Wavefront Path Tracing on GPU</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#24671849-fb9d-43d2-9506-201ae974a410">2.1.1 Our connection with GPU</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f7bd5607-d409-4aa5-8f75-ddc8ac6b3515">2.2 Smoke simulation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1eac9d8f-6677-4e98-968e-2e43eb43ec66">2.3 MGPCG Algorithm(Used for smoke)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#cd64168b-f85a-40db-b7d8-bad714e0f3da">2.3.1 Method Overview of MGPCG</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#d5ebf5de-bbf4-485b-9d7e-d59f21eb9780">2.3.2 Our implement</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#21fe261f-30c8-4780-9433-a0c3a633904b">2.4 Fluid simulation</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#313d15fc-87a4-4175-b02c-9497e10702b7">3. Results</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4704f5b2-f59d-41fd-abfe-f103a24f861a">3.1 Smoke simulation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#42622515-8c54-4681-9300-11344b7375fb">3.2 Fluid simulation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4b22c9e4-405e-47ee-9b26-20818b907d00">3.3 Smoke plus Fluid with cute bunny</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#33e7b6d5-ec7f-4a87-9e80-f0aeeb1321d4">4. Reference</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5f925944-3d3b-42d0-9e87-acfc5089adbc">5. Contributions from each team member</a></div></nav><p id="4fe4fe1d-d4c5-4e95-ae24-738a874aeb85" class="">
</p><p id="f0a06f07-ac0a-4688-a4cd-fac8e705e040" class="">Our video(an overview to the whole project): </p><figure id="be5066eb-cc9b-4cd9-92be-8dbf270aa04e"><div class="source"><a href="https://youtu.be/YADNiKvSSjM">https://youtu.be/YADNiKvSSjM</a></div></figure><h1 id="15b7d7a6-b0cf-4222-a8f6-10ce973144a3" class="">1. Abstract</h1><p id="0f2056c9-6955-465f-bcb9-473b9a73842f" class="">In this final project, we implemented a smoke simulator on the GPU and, leveraging the parallel nature of GPUs, designed and implemented two different parallel solvers. Our carefully optimized MGPCG solver achieved excellent convergence results. Additionally, we also implemented wavefront path tracing, adapted to the GPU architecture, and extended it to volume rendering. Although we attempted to port the free surface solver to the CPU, we were unable to complete it due to the framework&#x27;s lack of support for atomic operations. Therefore, we focused on optimizing the existing CPU solver. Ultimately, we created a scene containing both smoke simulation and free surface fluid simulation, rendered it into a video using our GPU renderer. Our code and models will be at <a href="https://github.com/CLV-Iclucia/SimCraft">https://github.com/CLV-Iclucia/SimCraft</a>.</p><h1 id="846a9a20-cab9-4cd9-9524-45742c590eef" class="">2. Technical approach</h1><h2 id="20a9cf76-c681-4530-929f-f0d22d4e4407" class="">2.0 Preliminary: Volumetric Path Tracing</h2><p id="d94a4141-dc2a-43f4-853f-1e84644f9241" class="">Path tracing is a physically based rendering technique that simulates the propagation of light through a scene to produce realistic images. In the course before, we have learned about path tracing, where light rays may collide with objects in the scene and be reflected, refracted, or absorbed. The tracking process ends when it intersects with a light source, when it does not intersect with the scene, or when it reaches Russian Roulette (RR).</p><p id="b00907b8-55b8-46e4-9024-662d82432f53" class="">Later we will review our class knowledge and introduce some new important concepts.</p><h3 id="efe05829-2e50-4e31-849f-55ef4ea7e760" class="">2.0.1 Path Tracing(Lessons learned)</h3><p id="2f5cb33e-ec69-455f-82ca-f0422ae4dda8" class="">In our class, we learn the preliminary ray tracing model shown as below figure. We can summarize it as: we start with primary rays, which are rays that go from our eye point through a pixel on the image plane and intersect some geometry in our scene. We then trace secondary rays until we hit a non-specular surface, or reach the maximum desired recursion level. At each hit point, we trace shadow rays to our light source(s) to test light visibility. The final pixel color is the weighted sum of the contributions along the rays. This allows us to have more sophisticated effects (e.g. specular reflection, refraction, and shadows) — but there&#x27;s much more we can do to derive a physically-based illumination model.</p><figure id="0c9f9302-4912-4a52-b314-51f6f81690e5" class="image"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled.png"><img style="width:432px" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled.png"/></a><figcaption>Figure 1: Ray Casting diagram, refer to the course slide[2]</figcaption></figure><h3 id="687a8691-828b-4db7-9057-bb41f43ebcd4" class="">2.0.2 Volumetric Path Tracing</h3><p id="d57378ae-0bae-4a32-a54b-c03172d8c129" class="">Volumetric Path Tracing extends the basic ray tracing model to account for participating media such as fog, smoke, or clouds within the scene. In addition to tracing rays through geometric surfaces, Volumetric Path Tracing also simulates the interaction of light with these participating media.</p><p id="84f347a9-6c3d-431e-b290-3091cb6dfb0b" class="">The core concept in it is the Radiative Transfer Equation:</p><figure id="5218667f-7b29-4d5a-b554-16e7721d9870" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mfrac><mi>L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>σ</mi><mi>a</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>L</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mo>∫</mo><msup><mi>S</mi><mn>2</mn></msup></msub><mi>ρ</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo separator="true">,</mo><msup><mi>ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi>L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><msup><mi>ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\mathrm{d}}{\mathrm{d}t}L(\vec{p}(t),\omega)=-(\sigma_a(\vec{p}(t))+\sigma_s(\vec{p}(t)))L(\vec{p}(t),\omega)+L_e(\vec{p}(t),\omega)+\sigma_s(\vec{p}(t))\int_{S^2}\rho(\vec{p}(t),\omega,\omega&#x27;)L(\vec{p}(t),\omega&#x27;)\mathrm{d}\omega&#x27;.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)))</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2719em;vertical-align:-0.9119em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3895em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathrm">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></div></figure><p id="d0fe5477-aae3-491a-9e22-e8c3076300b2" class="">In the radiative transfer equation, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mi>L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \frac{d}{dt} L(\vec{p}(t), \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> indicates how the radiance, which is the light intensity emitted or reflected by a point in a given direction, changes at point <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{p}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> in the direction <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></span><span>﻿</span></span> as time progresses. </p><p id="b1679bd2-037c-4476-a186-0083d3001b94" class="">The coefficients <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>a</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_a(\vec{p}(t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_s(\vec{p}(t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span><span>﻿</span></span> represent the medium&#x27;s propensity to absorb and scatter light, respectively. The radiance at the point is denoted by<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(\vec{p}(t), \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L_e(\vec{p}(t), \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> is any radiance that might be emitted by the point itself. The phase function <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo stretchy="false">(</mo><mover accent="true"><mi>p</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ω</mi><mo separator="true">,</mo><msup><mi>ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rho(\vec{p}(t), \omega, \omega&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> gives the likelihood of light scattering from one direction to another. The integral <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∫</mo><msup><mi>S</mi><mn>2</mn></msup></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo><mi>d</mi><msup><mi>ω</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\int_{S^2} (...) d\omega&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1608em;vertical-align:-0.3558em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1666em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3558em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">...</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> accumulates the scattering contributions from all possible directions across the sphere, summing to determine the total effect on radiance at the point due to scattering. </p><p id="ce8683a7-1d56-4dde-9a8b-c6d8b0fcece0" class="">This equation plays a crucial role in simulating how light travels through and interacts with various media in computer graphics, providing a more realistic depiction of scenes with participating media such as fog or smoke.</p><h2 id="a6f6ea69-ec76-4695-99ab-ee7c271d5f56" class="">2.1 Wavefront Path Tracing on GPU</h2><p id="3e187132-4c27-4950-b7d6-b77ea0ef68bc" class="">In our project, we use wavefront path tracing, which is an advanced technology for path tracing on GPU, designed to overcome the performance bottleneck of traditional megakernel methods. In traditional methods, the divergence in processing complex materials and control flow often leads to underutilization of GPU resources and low execution efficiency. The Wavefront approach significantly improves rendering efficiency by segmenting processing paths and optimizing GPU memory usage.</p><p id="f0dce99c-fa00-4572-927b-54b7093a33ff" class="">The core of the Wavefront Path Tracing method is to divide the path tracing task into three stages: logic, material, and ray casting. Each stage consists of one or multiple individual kernels. Figure 2 illustrates the design. </p><figure id="e5f644c6-5a9e-4fec-9c60-044dafc5b77d" class="image"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled%201.png"><img style="width:409px" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled%201.png"/></a><figcaption>Figure 2: The design of wavefront path tracer. Each green<br/>rectangle represents an individual kernel, and the arrows indicate<br/>queue writes performed by kernels [1]<br/></figcaption></figure><ul id="ef05be05-7421-4b8e-977b-2c8757b17e4f" class="toggle"><li><details open=""><summary>Below we introduce these three stages in detail(Click the arrow to see)</summary><ul id="d0b43654-1fe4-412d-a1ec-c4e14ff089f3" class="bulleted-list"><li style="list-style-type:disc"><strong><strong>Logic Stage</strong></strong><p id="d9624340-1bb7-4113-8b5c-61e5aef9ab7e" class="">The Logic Stage in path tracing governs the fundamental operations required for ray progression, maintaining fidelity to physical and optical principles. It orchestrates the calculation of multiple importance sampling weights, updates path flux, accumulates direct light source contributions, evaluates path termination conditions, manages terminated path contributions to the final image, generates new light source samples, identifies material properties at collision points, and initiates requests for material evaluation. This comprehensive approach ensures systematic adherence to rendering standards and facilitates the accurate portrayal of scenes.</p></li></ul><ul id="cf23bcba-8569-40eb-adaa-34c60f06208e" class="bulleted-list"><li style="list-style-type:disc"><strong>Material stage</strong><p id="c2c77528-5cee-4037-a32d-9b906555d6c6" class="">This part is mainly about the interaction with different materials. </p><p id="7a06397f-ea7f-48e2-a2fa-de85cede877f" class="">In Wavefront Path Tracing, paths undergo classification into ended paths, which initiate new camera rays for subsequent cycles, and ongoing paths, which undergo material property analysis at the impact point. To enhance rendering efficiency, different materials are allocated to specific processing cores according to their complexity, minimizing control flow divergence. Based on material evaluation outcomes, new rays, such as extended or shadow rays, may be generated and forwarded for further processing in the rendering pipeline. In case of ray generation issues, like incorrect directionality, termination of the path occurs, ensuring accurate rendering outcomes and optimal resource utilization.</p></li></ul><ul id="07e89f1c-43ad-4ce4-9392-a9189e91bfd9" class="bulleted-list"><li style="list-style-type:disc"><strong>Ray cast stage</strong><p id="49a6c4af-4723-4199-bfc9-19079fc77b2d" class="">The ray casting stage is the final step in Wavefront Path Tracing. It calculates intersections between rays and scene objects, gathering information like position and material type. This data is then processed to determine physical properties. Results are cached for future use in advancing the path and evaluating materials.</p></li></ul></details></li></ul><p id="2e95cb5f-cadb-4c1a-8ee6-ceea39da86b6" class="">In addition to these three stages, some memory tricks are used to speed up tracking.</p><p id="1f2641ae-2eb9-4041-99f0-8f24ce9f81dc" class="">The Wavefront approach in path tracing uses a memory-based system rather than local registers for storing path status data, which is mitigated by adopting a Structure of Arrays (SOA) layout to reduce memory access frequency. Additionally, the use of pre-allocated queue systems in Wavefront Path Tracing enhances rendering optimization. These queues store path indices in global memory buffers and utilize atomic operations for data accuracy and synchronization. Efficiency is further improved by merging atomic operations within a warp through warp-wide voting operations, which optimizes memory access and reduces performance issues caused by individual atomic operations.</p><h3 id="24671849-fb9d-43d2-9506-201ae974a410" class="">2.1.1 Our connection with GPU</h3><p id="5b3e76a9-cb85-4a78-931a-3cd11f814142" class="">In our rendering framework, the phase function, analogous to the BRDF for surfaces, accounts for the scattering events that alter light directions and is evaluated during the material stage alongside other BRDFs. To unbiasedly estimate the transmittance through non-uniform media, we employ a method known as null scattering[5], which randomly decides whether the light will &#x27;continue forward&#x27; or &#x27;scatter and change direction&#x27;. As scenes may contain multiple media types, we iterate until a ray necessitates volume scattering or hits a surface, both scenarios being part of the material stage unless it strikes a light source or finds no intersection. The third stage of our process involves advancing the ray until scattering occurs, seamlessly integrating volume rendering within the Wave Path Tracing (WPT) framework.</p><p id="b56d3fb7-27cb-4b87-ad97-c8c87eb04739" class="">While a perfect integration of GPU and Volume Path Tracing (VPT) remains elusive, our approach minimizes memory access and divergence during this phase. We optimize using CUDA&#x27;s shared memory to cache frequently used data and employ Morton coding to sort rays for spatial coherence within warps, significantly improving performance in our WPT setup.</p><blockquote id="87b2f6dc-906b-4bfe-b3c8-b139e5ae2f1f" class="">As for “the problems we encountered and how we tackled them”, to facilitate understanding, we have described different technical parts separately and not unified them together.</blockquote><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="94b0871a-c8a5-4646-b502-cba2243769f9"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><strong>Checkpoint<br/><br/>So now we have completed the description of VPT(Volumetric Path Tracing) and WPT(Wavefront Path Tracing), which will be the basis for our subsequent smoke and fluid simulation.<br/></strong></div></figure><h2 id="f7bd5607-d409-4aa5-8f75-ddc8ac6b3515" class="">2.2 Smoke simulation</h2><p id="1b99ea6c-15aa-42e0-b88b-8b43473042dd" class="">Smoke simulations are usually based on the Navier-Stokes equations describing fluid motion.</p><p id="d17557ac-696f-4c33-a7ec-e800c51e6ab5" class="">The Navier-Stokes equations are fundamental in fluid mechanics, describing the motion of fluids such as gases and liquids. These equations consist of two parts: the momentum equation and the continuity equation.</p><ol type="1" id="1afbb4f0-2abe-499b-ba5e-920a97337b24" class="numbered-list" start="1"><li>Momentum Equation<p id="93f48b31-d8f7-4414-b644-f97029b80a6d" class="">The momentum equation describes changes in the fluid velocity, incorporating effects of fluid inertia, internal viscosity, external forces applied, and pressure gradients. For an incompressible, viscous fluid, the momentum equation typically takes the form:</p><figure id="fc6cba68-6143-41cf-833a-535b732aea32" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo stretchy="false">)</mo><mi mathvariant="bold">u</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mi mathvariant="normal">∇</mi><mi>p</mi><mo>+</mo><mi>ν</mi><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi mathvariant="bold">u</mi><mo>+</mo><mi mathvariant="bold">f</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} = -\frac{1}{\rho} \nabla p + \nu \nabla^2 \mathbf{u} + \mathbf{f}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mclose">)</span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ρ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∇</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="mord">.</span></span></span></span></span></div></figure><p id="2840b840-2b19-44b2-b4cd-cf2de087b491" class="">Where: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">\mathbf{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">u</span></span></span></span></span><span>﻿</span></span> is the fluid velocity field, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> is time, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></span><span>﻿</span></span> is the fluid density (constant for incompressible fluids), <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></span><span>﻿</span></span> is the fluid pressure, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span></span></span></span></span><span>﻿</span></span> is the kinematic viscosity coefficient, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">f</mi></mrow><annotation encoding="application/x-tex">\mathbf{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span><span>﻿</span></span> represents external forces per unit mass (such as gravity).</p></li></ol><ol type="1" id="ae59f5cc-bc22-465f-9601-f2575cfb9b66" class="numbered-list" start="2"><li>Continuity Equation<p id="d2330ac9-55ac-4872-bd54-e916ae99e9b6" class="">The continuity equation ensures the conservation of fluid mass, which for incompressible fluids means that the density of the fluid does not change during its motion. This is expressed as the divergence of the velocity field being zero:</p><figure id="e0d1a9b1-e7b4-4307-a3e0-7474113ce7eb" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo>=</mo><mn>0.</mn></mrow><annotation encoding="application/x-tex">\nabla \cdot \mathbf{u} = 0.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.</span></span></span></span></span></div></figure></li></ol><p id="121c074a-21d0-44b2-a1fd-d5409d440c3d" class="">In smoke simulation, to maintain the incompressibility of the fluid, the pressure Poisson equation needs to be solved. This equation is derived from combining the continuity equation and momentum equation of the Navier-Stokes equations to find the pressure field that results in a divergence-free velocity field.</p><p id="373152bf-023b-470d-b29f-f8a50f1d8c26" class="">After discretizing the time component of the momentum equation and substituting it into the continuity equation, we obtain the general form of the pressure Poisson equation:</p><figure id="99c95a5a-a254-4e46-8362-a46103a89eb5" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo stretchy="false">)</mo><mi mathvariant="bold">u</mi><mo>+</mo><mi>ν</mi><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi mathvariant="bold">u</mi><mo>+</mo><mi mathvariant="bold">f</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla^2 p = \nabla \cdot \left( -\frac{1}{\rho} (\mathbf{u} \cdot \nabla) \mathbf{u} + \nu \nabla^2 \mathbf{u} + \mathbf{f} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ρ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∇</span><span class="mclose">)</span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></div></figure><p id="d234d35e-809c-4326-a7ce-eb029e892d0f" class="">This equation indicates that the Laplacian of the pressure <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\nabla^2 p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> equals the divergence of the nonlinear terms, viscous terms, and external forces of the velocity field. By solving this equation, the pressure field is updated, thereby adjusting the velocity field to meet the incompressibility condition <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\nabla \cdot \mathbf{u} = 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>.</p><p id="c8957013-97b2-4186-8f56-d7f9936a91cc" class="">Through solving these equations, the dynamics of smoke and other fluids can be realistically reproduced in computer graphics, making the visual effects both beautiful and scientifically accurate.</p><h2 id="1eac9d8f-6677-4e98-968e-2e43eb43ec66" class="">2.3 MGPCG Algorithm(Used for smoke)</h2><p id="91273f0a-df6c-4f9c-8d30-dbf12ccfb44b" class="">Above we have a basic introduction to smoke. A major challenge in high-performance smoke simulation is how to efficiently solve the system of fluid dynamics equations, especially when simulating large-scale dynamic scenarios. Although the traditional direct solution method is simple, it is time-consuming and resource-consuming when processing large-scale data.</p><p id="cadf9505-d557-4438-abc5-5e9a71dcd83f" class="">MGPCG is an efficient solver for Poisson equations over irregular voxelized domains, accommodating Dirichlet and Neumann boundary conditions. It employs a multi-grid loop as a preconditioner within the conjugate gradient method, utilizing a geometric multi-grid scheme to enhance convergence speed and robustness. Designed for parallel execution, MGPCG is implemented on shared memory platforms, optimizing for low bandwidth and memory usage.</p><h3 id="cd64168b-f85a-40db-b7d8-bad714e0f3da" class="">2.3.1 Method Overview of MGPCG</h3><ol type="1" id="f610c629-c2d8-4d03-85ce-418c17a32cec" class="numbered-list" start="1"><li>Multigrid Preconditioning:<p id="9b9f3571-c35c-471c-b15d-119865c84c51" class="">Multigrid preconditioning is a technique based on solving problems at different scales to accelerate the solution process. This method starts with the finest grid and progressively builds coarser grid levels, each with different resolution accuracy.</p><ul id="6c1e2ea7-15fb-4a54-88ca-7c1fb102691c" class="bulleted-list"><li style="list-style-type:disc"><strong>Refinement and Coarsening:</strong> The process of grid refinement and coarsening is carried out by restricting the solution from finer grids to coarser ones and interpolating the solution from coarse grids back to fine grids. This method is implemented through the V-Cycle algorithm described in Algorithm 1, which includes smoothing operations, restriction, and interpolation steps.</li></ul><ul id="e600bc07-baee-44f6-a3ff-e74858428aa5" class="bulleted-list"><li style="list-style-type:disc"><strong>Smoothers:</strong> Simple iterative methods such as weighted Jacobi or Gauss-Seidel are used at each grid level to reduce errors. These smoothing operations help to eliminate high-frequency error components, thus improving the quality of the numerical solution.</li></ul><ul id="5e92ee92-c333-4c4f-bb2e-7dc52d60e055" class="bulleted-list"><li style="list-style-type:disc"><strong>Restriction and Interpolation:</strong> The restriction operation transfers residuals from fine to coarse grids, and interpolation methods transfer the corrected solutions back to fine grids. These operations are performed using specific operators (e.g., full-weighting restriction operator and bilinear interpolation operator), which transfer information between grid levels.</li></ul></li></ol><ol type="1" id="446d2b63-cad5-4cd7-b11e-f5342417bf82" class="numbered-list" start="2"><li>Multigrid as a Preconditioner for Conjugate Gradient Method:<p id="25dc405b-40b5-4ef3-865f-ef16098e78a5" class="">Combining multigrid preconditioning with the Conjugate Gradient method can significantly accelerate the convergence rate of solving linear systems, especially when dealing with large-scale problems.</p><p id="755dfe89-2107-413d-a1d5-ff4c32f8b6c2" class="">Specifically, we adopted and implemented the algorithm in the paper, as shown below:</p><figure id="ed0df205-bd1d-4a65-8fc5-c9662837a12c" class="image" style="text-align:center"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/8e8c45b6-80b7-4405-ae78-a357d73a9962.png"><img style="width:336px" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/8e8c45b6-80b7-4405-ae78-a357d73a9962.png"/></a><figcaption><strong>Algorithm 1: </strong>V-Cycle of the Multigrid Correction Scheme. [3]</figcaption></figure></li></ol><h3 id="d5ebf5de-bbf4-485b-9d7e-d59f21eb9780" class="">2.3.2 Our implement</h3><p id="223e5216-3432-4a77-adfa-bf60d7ed33da" class="">Since the equation systems solved by the bottom solver are quite small, using multiple kernel calls for iterative solving is not efficient and results in significant waste. We have designed a specialized solving kernel that stores all the small equation systems on the coarsest grid into shared memory. This allows repeated iterations within the kernel function itself, greatly reducing communication with the host machine.</p><h2 id="21fe261f-30c8-4780-9433-a0c3a633904b" class="">2.4 Fluid simulation</h2><p id="76f53f01-0594-4ed2-be6b-fc1696a538d6" class="">We have introduced the Navier-Stokes equation in smoke simulation. Fluid simulation is also based on this equation. The difference is that in liquid simulation, specific methods are employed to handle the unique challenges of modeling incompressible and highly interactive fluids. Unlike smoke simulation, which primarily deals with the dispersion and diffusion within a more compressible medium, liquid simulation requires careful handling of free surface flows, viscosity control, and the interaction dynamics between particles.</p><p id="43c1ba62-5ee0-4f80-8398-c9db26ed082f" class="">Initially, we employed the PIC (Particle-In-Cell[9]) method coupled with a naive spatial hashing approach to locate neighboring particles for reconstructing the Signed Distance Function (SDF[10]). This approach faced two major issues: excessive numerical viscosity and poor memory access locality during SDF reconstruction, which became a performance bottleneck.</p><p id="8905de2f-8ba5-40c4-b6f4-e4199278a71b" class="">To mitigate the issue of numerical viscosity, we later adopted the FLIP (Fluid Implicit Particle[11]) algorithm. While FLIP inherently suffers from high noise levels, we combined it with PIC interpolation to strike a balance, reducing numerical viscosity and achieving smoother fluid animations.</p><p id="75344e43-4add-44b5-be86-fcddd86f70a3" class="">Moreover, we enhanced our spatial hashing by implementing Morton coding[13] for mapping, which effectively utilized cache and improved spatial locality. This allowed us to simulate with a higher number of particles, significantly improving the quality of the fluid simulation.</p><p id="1a2e66bc-1c94-4165-94ad-303103da34ea" class="">Additionally, we began calculating the CFL (Courant-Friedrichs-Lewy[12]) number for the velocity field to adaptively adjust the time step, thereby enhancing accuracy. Although this adjustment impacted performance, it notably improved the quality of the fluid simulation.</p><h1 id="313d15fc-87a4-4175-b02c-9497e10702b7" class="">3. Results</h1><h2 id="4704f5b2-f59d-41fd-abfe-f103a24f861a" class="">3.1 Smoke simulation</h2><p id="8dee7fcc-c886-48cd-bbdf-69e697ac1b3c" class="">For the simulation of smoke, we used two methods. The first method is damped jacobi iteration. It takes 5000 iterations to reach the convergence state. In the table below, we record the changes in indicators(contain residual) with the number of iterations.</p><table id="68370e94-6594-4f37-8be0-40d22532f273" class="simple-table"><tbody><tr id="8b25dc08-f73c-4b3f-9863-9056a83b4a03"><td id="BTk?" class="" style="width:345px">iter</td><td id="zze]" class="" style="width:345px">residual</td></tr><tr id="b4bce251-9488-47f7-b8a5-e4d6700489a5"><td id="BTk?" class="" style="width:345px">4996</td><td id="zze]" class="" style="width:345px">0.091385</td></tr><tr id="07b4aafa-fe8b-4d44-9f7f-1a15a62291f0"><td id="BTk?" class="" style="width:345px">4997</td><td id="zze]" class="" style="width:345px">0.091331</td></tr><tr id="f1d785b7-1f95-4372-a0d1-935d143096ad"><td id="BTk?" class="" style="width:345px">4998</td><td id="zze]" class="" style="width:345px">0.091308</td></tr></tbody></table><p id="012f1d50-9cab-4a67-b59b-fcd308575ec5" class="">The second method is parallel MGPCG iteration, which can reach convergence in about twenty iterations. The specific residual indicators are as shown in the table below.</p><table id="242decac-0905-4bd7-8405-be827c253b7b" class="simple-table"><tbody><tr id="4b8dd167-6625-4d73-801d-113a228a6a5a"><td id="]UZB" class="" style="width:345px">iter</td><td id="Yi;g" class="" style="width:345px">residual</td></tr><tr id="9e4b4d37-8d5a-46a5-95a5-61eca5f2da0a"><td id="]UZB" class="" style="width:345px">23</td><td id="Yi;g" class="" style="width:345px">0.051727</td></tr><tr id="c5db5d89-845e-4356-8680-91155e89a540"><td id="]UZB" class="" style="width:345px">24</td><td id="Yi;g" class="" style="width:345px">0.036713</td></tr><tr id="c6b590f4-b97a-4bc8-bd68-080e704ee7eb"><td id="]UZB" class="" style="width:345px">25</td><td id="Yi;g" class="" style="width:345px">0.026437</td></tr></tbody></table><p id="3679f3d2-bf70-41ef-a450-2ae00b3fcff7" class="">Below we render a schematic diagram except for the smoke simulation.</p><figure id="17064ccd-b0ef-4916-91be-0897a629247d"><div class="source"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/WeChat_20240501001715.mp4">https://prod-files-secure.s3.us-west-2.amazonaws.com/e1b89df9-305f-43df-9242-9710c4b73a7e/7b160d02-7b62-4ef6-b32d-12be04720a89/WeChat_20240501001715.mp4</a></div></figure><h2 id="42622515-8c54-4681-9300-11344b7375fb" class="">3.2 Fluid simulation</h2><p id="d42522c7-5fff-48b2-a8f1-82df11070fae" class="">Based on the method we introduced before, we simulated the flow of liquid, and the preliminary result diagram obtained is as follows:</p><figure id="f4e815dc-f2ad-4ee8-816f-b0add0d2bbac" class="image"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled.gif"><img style="width:480px" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled.gif"/></a><figcaption>If you find that this gif does not move, you can click it or refresh the page</figcaption></figure><p id="2764d012-bfb3-426f-85fd-f1b64da21979" class="">Some problems can be seen from the effect, such as water droplets appearing and disappearing, and the fluid surface is very unstable (noisy)</p><p id="06a049c1-45a3-4101-9cb4-75498dfba636" class="">We made some adjustments to slightly increase the radius of the particles, making it easier for the particle details to be captured by the mesh. At the same time, each frame is divided into multiple sub-steps, and the size of the sub-steps is adaptively adjusted by calculating the CFL number of the flow field, making the solution more accurate and the fluid more stable. The effect obtained is as follows</p><figure id="efb47b16-fcec-43d4-8669-f5e65de28ec9" class="image"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled%201.gif"><img style="width:480px" src="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/Untitled%201.gif"/></a><figcaption>If you find that this gif does not move, you can click it or refresh the page. </figcaption></figure><h2 id="4b22c9e4-405e-47ee-9b26-20818b907d00" class="">3.3 Smoke plus Fluid with cute bunny</h2><p id="d794f4e4-41e5-4872-91ff-e30eb0525dde" class="">We integrated the bunny in the class and the fluid and smoke in this project to get the following rendering video.</p><figure id="d29c4b5f-a2cd-42e4-8c58-0d9b0d9c61e2"><div class="source"><a href="CS-184%20Final%20Project%20Fluid%20and%20Smoke%20Animation%20on%20%20520ccbe640be4e95be7ad63a1df1971f/WeChat_20240430235940.mp4">https://prod-files-secure.s3.us-west-2.amazonaws.com/e1b89df9-305f-43df-9242-9710c4b73a7e/8b69663b-3377-40b3-b210-0ad726262e8b/WeChat_20240430235940.mp4</a></div></figure><h1 id="33e7b6d5-ec7f-4a87-9e80-f0aeeb1321d4" class="">4. Reference</h1><ol type="1" id="74b02143-1e4b-4edf-b0a2-89401a13aef2" class="numbered-list" start="1"><li>Laine, Samuli, Tero Karras, and Timo Aila. &quot;Megakernels considered harmful: Wavefront path tracing on GPUs.&quot; <em>Proceedings of the 5th High-Performance Graphics Conference</em>. 2013.</li></ol><ol type="1" id="38b88adc-d6d1-4097-9923-99c8d18ced15" class="numbered-list" start="2"><li>&quot;Ray Tracing and Acceleration Structures.&quot; <a href="http://cs184.eecs.berkeley.edu/">cs184.eecs.berkeley.edu</a>, <a href="https://cs184.eecs.berkeley.edu/sp24/lecture/9/ray-tracing-and-acceleration-str">https://cs184.eecs.berkeley.edu/sp24/lecture/9/ray-tracing-and-acceleration-str</a>.</li></ol><ol type="1" id="69d3ee39-be1b-485d-a56d-3d3176e15b73" class="numbered-list" start="3"><li>McAdams, Aleka, Eftychios Sifakis, and Joseph Teran. &quot;A Parallel Multigrid Poisson Solver for Fluids Simulation on Large Grids.&quot; <em>Symposium on Computer Animation</em>. Vol. 65. 2010.</li></ol><ol type="1" id="0772606e-d73f-4da8-93d9-42f9a5ca6ffb" class="numbered-list" start="4"><li>Clv, I. (2024, April 30). VPT on GPU. Lucidic Computing. <a href="https://clv-iclucia.github.io/2024/04/24/VPT-on-GPU/">https://clv-iclucia.github.io/2024/04/24/VPT-on-GPU/</a></li></ol><ol type="1" id="6675c5e2-6918-4e2d-b879-baba15f679c4" class="numbered-list" start="5"><li>Miller, Bailey, Iliyan Georgiev, and Wojciech Jarosz. &quot;A null-scattering path integral formulation of light transport.&quot; <em>ACM Transactions on Graphics (TOG)</em> 38.4 (2019): 1-13.</li></ol><ol type="1" id="178c2e84-9d1c-4f73-b8fc-63bce5dacecb" class="numbered-list" start="6"><li>Bridson, R. (n.d.). <em>Fluid Simulation for Computer Graphics</em>. Retrieved from <a href="https://www.cs.ubc.ca/~rbridson/fluidsimulation/fluids_notes.pdf">https://www.cs.ubc.ca/~rbridson/fluidsimulation/fluids_notes.pdf</a></li></ol><ol type="1" id="077ab5da-e88b-456d-a268-8c8d28c8ca93" class="numbered-list" start="7"><li>ICLUCIA. (2022, September 13). <em>CSE 272 HW</em>. Retrieved from <a href="https://clv-iclucia.github.io/2022/09/13/CSE-272-Hw/">https://clv-iclucia.github.io/2022/09/13/CSE-272-Hw/</a></li></ol><ol type="1" id="d68c760e-c237-4572-b983-50f9133ddf1b" class="numbered-list" start="8"><li>Pharr, M., Jakob, W., &amp; Humphreys, G. (2018). <em>Physically Based Rendering: From Theory to Implementation (3rd ed.)</em>. Retrieved from <a href="https://www.pbr-book.org/3ed-2018/contents">https://www.pbr-book.org/3ed-2018/contents</a></li></ol><ol type="1" id="d0efd41a-f263-4d19-85cb-2a9a8f122388" class="numbered-list" start="9"><li>Tskhakaya, D. (2008). The particle-in-cell method. In <em>Computational many-particle physics</em> (pp. 161-189). Berlin, Heidelberg: Springer Berlin Heidelberg.</li></ol><ol type="1" id="a703f3b1-1077-4305-bb74-d9dbd13d2f7b" class="numbered-list" start="10"><li>Bridson, Robert. <em>Fluid simulation for computer graphics</em>. AK Peters/CRC Press, 2015.</li></ol><ol type="1" id="e94a7cc4-03f8-45ae-94e6-7e087968467b" class="numbered-list" start="11"><li>Brackbill, Jeremiah U., Douglas B. Kothe, and Hans M. Ruppel. &quot;FLIP: a low-dissipation, particle-in-cell method for fluid flow.&quot; <em>Computer Physics Communications</em> 48.1 (1988): 25-38.</li></ol><ol type="1" id="fbd9a3f3-8582-4c51-998a-7833f01d01e1" class="numbered-list" start="12"><li>Courant, Richard, Kurt Friedrichs, and Hans Lewy. &quot;Über die partiellen Differenzengleichungen der mathematischen Physik.&quot; <em>Mathematische annalen</em> 100.1 (1928): 32-74.</li></ol><ol type="1" id="729bfba0-398f-4e00-affb-1922852c80e7" class="numbered-list" start="13"><li>Morton, Guy M. &quot;A computer oriented geodetic data base and a new technique in file sequencing.&quot; (1966).</li></ol><h1 id="5f925944-3d3b-42d0-9e87-acfc5089adbc" class="">5. Contributions from each team member</h1><p id="737edc37-5e18-45f9-924a-416cb6b63457" class="">Xuanye Chen led this project and was responsible for wavefront path tracing on GPU and subsequent fluid and smoke simulations.</p><p id="33efe034-116f-4054-9d44-ad4c76e9a453" class="">Zhenzhe Li was responsible for the final deliverable materials of the report.</p><p id="f06e4e71-7fce-456b-9e1f-3f4a4817981c" class="">Ruijie Jian built the project on Windows, deployed tests for some GPU utils, helped with building the renderer, and made the final project video.</p><p id="70060ba0-beb4-412d-9173-125efd6a251c" class="">Huasen Xi mainly focuses on the MGPCG algorithm and correct some bugs.</p><p id="68b170d5-43b4-4496-b9b7-d7da79683751" class="">They participated in every discussion together and contributed to every deliverable.</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="83f96e39-efac-48cc-887d-ca52e5cf60e4"><div style="font-size:1.5em"><span class="icon">🙏</span></div><div style="width:100%"><strong>Thanks<br/><br/><br/></strong>In our experimental report, we extend our heartfelt gratitude to Dr. Shaokun Zheng from Tsinghua University for illuminating the wavefront approach and providing insightful inspiration for accelerating ray intersection computations. Likewise, we express our sincere appreciation to Dr. Zixuan Lu from the University of Utah for her guidance on spatial acceleration structures in GPU parallelism and for offering valuable suggestions for efficient GPU parallelism in the bottom solver of multigrid algorithms.</div></figure><p id="d5b6f448-0233-4e25-9d9e-c8df1b3294f2" class="">
</p><p id="9bf41565-89ad-490c-94f5-c1a4b3ecf834" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>